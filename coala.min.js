!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Coala=e():t.Coala=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i=n(1),r=n(3),o=n(5),s={observable:r,mount:function(t,e){return this.component(t).mount(e)},component:function(t){return new i(t)},router:function(t){return new o(t).start()}};r(s),t.exports=s},function(t,e,n){function i(t){if(this.opts=t||{},this.listen=this.opts.listen||{},this.handle=this.opts.handle||{},o(this),this._mixin(),this._listenTo(),$.isFunction(t.data)){var e=t.data.call(this);e&&e.promise?(this.promise=e,this.data=this.data||{}):this.data=e}else this.data=$.extend(!0,$.isArray(t.data)?[]:{},t.data);this._initRefs(),this.trigger("init")}var r=n(2),o=n(3),s=n(4);i.prototype={_initRefs:function(){if(this.opts.refs){this.refs={};for(var t in this.opts.refs){var e=this.opts.refs[t],n=new i(e.component);e.data&&(n.data=$.isArray(e.data)?e.data:$.extend(!1,e.component.data,e.data)),n.refOpts=e,n.parent=this,this.refs[t]=n}}},_bindEvents:function(){if(this.opts.events)for(var t in this.opts.events){var e=this.opts.events[t],n=t.indexOf(" ");if(-1===n)throw"The "+e+" event is not separated by whitespace.";if(!this.handle[e])throw"The "+e+" handle is not defined.";var i=t.substr(n+1,t.length);this.el.on(t.substr(0,n),i,$.proxy(this.handle[e],this))}},_mixin:function(){this.opts.mixins&&($.isArray(this.opts.mixins)||(this.opts.mixins=[this.opts.mixins]),$.extend.apply($,[!0,this].concat(this.opts.mixins)))},_listenTo:function(){for(var t in this.listen){var e=this.listen[t];this.on(t,e)}},mount:function(t){var e=this;return this.promise?this.promise.done(function(n){e.data.resource=n,e._mount(t),delete e.promise}):this._mount(t),this},_mount:function(t){if(this.trigger("update"),t&&(this.parent?(this.es=this.parent.es+" "+t,this.el=this.parent.$(t)):(this.es=t,this.el=$(t))),this.opts.tpl){var e=this.el.clone();e.html(this.opts.tpl(this.data)),s(e,this.es),this.el.append(e.html()),this._bindEvents();for(var n in this.refs){var i=this.refs[n];i.mount(i.refOpts.el)}}return this.trigger("updated").trigger("mount"),this},update:function(t){return t&&$.extend(this.data,t),r(this.el[0],this._update()[0],{onBeforeElUpdated:function(t){return"STYLE"===t.tagName?!1:!0}}),this._updated(),this},_update:function(){if(this.trigger("update"),!this.opts.tpl)return"";var t=this.el.clone();t.html(this.opts.tpl(this.data));for(var e in this.refs){var n=this.refs[e];t.find(n.refOpts.el).html(n._update().html())}return t},_updated:function(){for(var t in this.refs)this.refs[t]._updated();this.trigger("updated")},unmount:function(){this._unmount(),this.el&&this.el.empty().off()},_unmount:function(){for(var t in this.refs)this.refs[t]._unmount();this.trigger("unmount").off("*")},$:function(t){return this.el.find(t)}},t.exports=i},function(t){"use strict";function e(t){!d&&l.createRange&&(d=l.createRange(),d.selectNode(l.body));var e;return d&&d.createContextualFragment?e=d.createContextualFragment(t):(e=l.createElement("body"),e.innerHTML=t),e.childNodes[0]}function n(t,e,n){t[n]!==e[n]&&(t[n]=e[n],t[n]?t.setAttribute(n,""):t.removeAttribute(n,""))}function i(){}function r(t,e){var n=t.nodeName,i=e.nodeName;return n===i?!0:e.actualize&&n.charCodeAt(0)<91&&i.charCodeAt(0)>90?n===i.toUpperCase():!1}function o(t,e){return e&&e!==p?l.createElementNS(e,t):l.createElement(t)}function s(t,e){if(e.assignAttributes)e.assignAttributes(t);else{var n,i,r,o,s,a,u=e.attributes;for(n=u.length-1;n>=0;--n)i=u[n],r=i.name,o=i.namespaceURI,s=i.value,o?(r=i.localName||r,a=t.getAttributeNS(o,r),a!==s&&t.setAttributeNS(o,r,s)):(a=t.getAttribute(r),a!==s&&t.setAttribute(r,s));for(u=t.attributes,n=u.length-1;n>=0;--n)i=u[n],i.specified!==!1&&(r=i.name,o=i.namespaceURI,o?(r=i.localName||r,h(e,o,r)||t.removeAttributeNS(o,r)):h(e,null,r)||t.removeAttribute(r))}}function a(t,e){for(var n=t.firstChild;n;){var i=n.nextSibling;e.appendChild(n),n=i}return e}function u(t){return t.id}function f(t,n,f){function d(t){w?w.push(t):w=[t]}function h(t,e){if(t.nodeType===m)for(var n=t.firstChild;n;){var i=void 0;e&&(i=A(n))?d(i):($(n),n.firstChild&&h(n,e)),n=n.nextSibling}}function c(t,e,n){S(t)!==!1&&(e&&e.removeChild(t),$(t),h(t,n))}function p(t){if(t.nodeType===m)for(var e=t.firstChild;e;){var n=A(e);n&&(U[n]=e),p(e),e=e.nextSibling}}function b(t){_(t);for(var e=t.firstChild;e;){var n=e.nextSibling,i=A(e);if(i){var o=U[i];o&&r(e,o)&&(e.parentNode.replaceChild(o,e),y(o,e))}b(e),e=n}}function y(e,i,o){var a,u=A(i);if(u&&delete U[u],!n.isSameNode||!n.isSameNode(t)){if(!o){if(E(e,i)===!1)return;if(s(e,i),T(e),R(e,i)===!1)return}if("TEXTAREA"!==e.nodeName){var f,h,p,N,w=i.firstChild,_=e.firstChild;t:for(;w;){for(p=w.nextSibling,f=A(w);_;){if(h=_.nextSibling,w.isSameNode&&w.isSameNode(_)){w=p,_=h;continue t}a=A(_);var S=_.nodeType,$=void 0;if(S===w.nodeType&&(S===m?(f?f!==a&&((N=U[f])?_.nextSibling===N?$=!1:(e.insertBefore(N,_),h=_.nextSibling,a?d(a):c(_,e,!0),_=N):$=!1):a&&($=!1),$=$!==!1&&r(_,w),$&&y(_,w)):(S===v||S==g)&&($=!0,_.nodeValue=w.nodeValue)),$){w=p,_=h;continue t}a?d(a):c(_,e,!0),_=h}if(f&&(N=U[f])&&r(N,w))e.appendChild(N),y(N,w);else{var L=C(w);L!==!1&&(L&&(w=L),w.actualize&&(w=w.actualize(e.ownerDocument||l)),e.appendChild(w),b(w))}w=p,_=h}for(;_;)h=_.nextSibling,(a=A(_))?d(a):c(_,e,!0),_=h}var O=x[e.nodeName];O&&O(e,i)}}if(f||(f={}),"string"==typeof n)if("#document"===t.nodeName||"HTML"===t.nodeName){var N=n;n=l.createElement("html"),n.innerHTML=N}else n=e(n);var w,A=f.getNodeKey||u,C=f.onBeforeNodeAdded||i,_=f.onNodeAdded||i,E=f.onBeforeElUpdated||i,T=f.onElUpdated||i,S=f.onBeforeNodeDiscarded||i,$=f.onNodeDiscarded||i,R=f.onBeforeElChildrenUpdated||i,L=f.childrenOnly===!0,U={};p(t);var O=t,I=O.nodeType,B=n.nodeType;if(!L)if(I===m)B===m?r(t,n)||($(t),O=a(t,o(n.nodeName,n.namespaceURI))):O=n;else if(I===v||I===g){if(B===I)return O.nodeValue=n.nodeValue,O;O=n}if(O===n)$(t);else if(y(O,n,L),w)for(var V=0,k=w.length;k>V;V++){var z=U[w[V]];z&&c(z,z.parentNode,!1)}return!L&&O!==t&&t.parentNode&&(O.actualize&&(O=O.actualize(t.ownerDocument||l)),t.parentNode.replaceChild(O,t)),O}var d,h,l="undefined"!=typeof document&&document,c=l?l.body||l.createElement("div"):{},p="http://www.w3.org/1999/xhtml",m=1,v=3,g=8;h=c.hasAttributeNS?function(t,e,n){return t.hasAttributeNS(e,n)}:c.hasAttribute?function(t,e,n){return t.hasAttribute(n)}:function(t,e,n){return!!t.getAttributeNode(n)};var x={OPTION:function(t,e){n(t,e,"selected")},INPUT:function(t,e){n(t,e,"checked"),n(t,e,"disabled"),t.value!==e.value&&(t.value=e.value),h(e,null,"value")||t.removeAttribute("value")},TEXTAREA:function(t,e){var n=e.value;if(t.value!==n&&(t.value=n),t.firstChild){if(""===n&&t.firstChild.nodeValue===t.placeholder)return;t.firstChild.nodeValue=n}},SELECT:function(t,e){if(!h(e,null,"multiple")){for(var n=-1,i=0,r=e.firstChild;r;){var o=r.nodeName;if(o&&"OPTION"===o.toUpperCase()){if(h(r,null,"selected")){n=i;break}i++}r=r.nextSibling}t.selectedIndex=i}}};t.exports=f},function(t){t.exports=function(t){t=t||{};var e={};return t.on=function(n,i){return"function"==typeof i&&(e[n]=e[n]||[]).push(i),t},t.off=function(n,i){if("*"!=n||i)if(i)for(var r,o=e[n],s=0;r=o&&o[s];++s)r==i&&o.splice(s--,1);else delete e[n];else e={};return t},t.one=function(e,n){function i(){t.off(e,i),n.apply(t,arguments)}return t.on(e,i)},t.trigger=function(n){var i,r,o,s=arguments.length-1,a=new Array(s);for(o=0;s>o;o++)a[o]=arguments[o+1];for(i=[].slice.call(e[n]||[],0),o=0;r=i[o];++o)r.apply(t,a);return e["*"]&&"*"!=n&&t.trigger.apply(t,["*",n].concat(a)),t},t}},function(t){function e(t,e){var n=new RegExp("([^\r\n,{}]+)(,(?=[^}]*{)|s*{)","g");return t=t.replace(n,function(t,n,i){return n.match(/^\s*(@media|@keyframes|to|from|@font-face)/)?n+i:(n.match(/:scope/)&&(n=n.replace(/([^\s]*):scope/,function(t,e){return e?" "+e:" "})),n=n.replace(/^(\s*)/,"$1"+e+" "),n+i)})}t.exports=function(t,n){if(!("scoped"in document.createElement("style"))){var i=t.find("style[scoped]");if(0!==i.length)for(var r=0;r<i.length;r++)i[r].innerHTML=e(i[r].innerHTML,n)}}},function(t){function e(t){n=this,this.opts=t,this.routes=t.routes,this._emit()}var n,i=[/[\-{}\[\]+?.,\\\^$|#\s]/g,/\((.*?)\)/g,/(\(\?)?:\w+/g,/\*\w+/g],r=function(t){return t=t.replace(i[0],"\\$&").replace(i[1],"(?:$1)?").replace(i[2],function(t,e){return e?t:"([^/?]+)"}).replace(i[3],"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},o=function(t,e){var n,i=t.exec(e).slice(1),r=[];for(n=0;n<i.length;n++)r.push(decodeURIComponent(i[n])||null);return r};e.prototype={_exec:function(t){for(var e in this.routes){var n=r(e);if(n.test(t))if("function"==typeof this.routes[e])this.routes[e].apply(this,o(n,t));else{var i=this.opts[this.routes[e]];i?i.apply(this,o(n,t)):void 0}}},_emit:function(t){var e=location.href.split("#")[1]||"/";n._exec(e,t)},start:function(){return window.addEventListener?window.addEventListener("hashchange",this._emit,!1):window.attachEvent("onhashchange",this._emit),this},stop:function(){return window.removeEventListener?window.removeEventListener("hashchange",this._emit,!1):window.detachEvent("onhashchange",this._emit),this},go:function(t){return location.hash=t,this},back:function(){return history.back(),this},add:function(t,e){return this.routes[t]=e,this},remove:function(t){return delete this.routes[t],this}},t.exports=e}])});