<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Coala Tutorial</title>
  <style>
    .todo {
      width: 50%;
      float: left;
    }
  </style>
  <script src="lib/jquery-1.11.3.js"></script>
  <script src="lib/art-template.js"></script>
  <script src="lib/coala.js"></script>
</head>
<body>
  <div id="todo1" class="todo"></div>
  <div id="todo2" class="todo"></div>

  <script id="template" type="text/html">
    <h1>{{title}}</h1>
    <input id="name">
    <button id="add">add</button>
    <ul>
      {{each list as value i}}
      <li>{{i + 1}} - {{value}} <a href="javascript:;" id="remove-{{i}}">x</a></li>
      {{/each}}
    </ul>
  </script>

  <script>
    var todo = {
      tpl: template.compile($('#template').html()),

      listen: {
        init: function() {
          this.data = {title: 'todo', list: ['学习 coala']};
        }
      },

      events: {
        'click #add': 'addTodo',
        'click [id^=remove-]': 'removeTodo'
      },

      handle: {
        addTodo: function() {
          this.data.list.push(this.$('#name').val());
          this.update();
        },

        removeTodo: function(e) {
          this.data.list.splice(e.target.id.split('-')[1], 1);
          this.update();
        }
      }
    };

    mount(todo, '#todo1');
    mount(todo, '#todo2');
  </script>

</body>
</html>
